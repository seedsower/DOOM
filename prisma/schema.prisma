// DOOM Protocol Database Schema
// Tracks token claims, user verification, and protocol metrics

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./doom.db"
}

model TokenClaim {
  id            String   @id @default(cuid())
  walletAddress String   @unique
  questionId    String
  answerHash    String
  claimedAt     DateTime @default(now())
  txSignature   String?  // Solana transaction signature
  amount        Int      @default(734)
  verified      Boolean  @default(true)
  
  @@map("token_claims")
}

model VerificationAttempt {
  id            String   @id @default(cuid())
  walletAddress String
  questionId    String
  answerHash    String
  isCorrect     Boolean
  attemptedAt   DateTime @default(now())
  ipAddress     String?
  userAgent     String?
  
  @@map("verification_attempts")
}

model ProtocolMetrics {
  id              String   @id @default(cuid())
  totalSupply     BigInt   @default(37000000)
  circulatingSupply BigInt @default(37000000)
  totalClaimed    BigInt   @default(0)
  totalBurned     BigInt   @default(0)
  uniqueHolders   Int      @default(0)
  lastUpdated     DateTime @default(now())
  
  @@map("protocol_metrics")
}

model Question {
  id          String @id @default(cuid())
  questionText String
  answerHash  String // SHA-256 hash of correct answer
  hint        String?
  pageRef     Int?   // Page reference if applicable
  difficulty  Int    @default(1) // 1-5 scale
  isActive    Boolean @default(true)
  createdAt   DateTime @default(now())
  
  @@map("questions")
}

model BunkerAccess {
  id            String   @id @default(cuid())
  walletAddress String   @unique
  accessLevel   Int      @default(1) // 1=basic, 2=advanced, etc.
  tokenBalance  BigInt   @default(0)
  lastChecked   DateTime @default(now())
  
  @@map("bunker_access")
}
